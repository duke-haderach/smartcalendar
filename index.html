<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Wall Dashboard</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script async defer src="https://apis.google.com/js/api.js" onload="gapiLoaded()"></script>
<script async defer src="https://accounts.google.com/gsi/client" onload="gisLoaded()"></script>

<style>
body {
  margin:0;
  font-family:Arial, sans-serif;
  background:black;
  color:white;
}
.panel {
  background:rgba(255,255,255,0.08);
  padding:12px;
  margin:12px;
  border-radius:8px;
}
#clock { font-size:32px; }
.event-item { margin-top:6px; }
#enable-voice {
  margin:8px 0;
  padding:6px 10px;
  background:#222;
  color:white;
  border:1px solid white;
  cursor:pointer;
}
</style>
</head>

<body>

<div class="panel">
  <div id="clock">--:--</div>
  <div id="date">Loading…</div>
</div>

<div class="panel">
  <h2>Upcoming Events</h2>
  <button id="enable-voice" style="display:none;">Enable voice alerts</button>
  <div id="events">Loading events…</div>
</div>

<script>
/* ========= BOOT CHECK ========= */
console.log("Dashboard JS started");

/* ========= DOM ========= */
const clockEl = document.getElementById("clock");
const dateEl = document.getElementById("date");
const eventsEl = document.getElementById("events");
const enableVoiceBtn = document.getElementById("enable-voice");

/* ========= CLOCK ========= */
function updateClock() {
  const now = new Date();
  clockEl.textContent = now.toLocaleTimeString([], {hour:"2-digit", minute:"2-digit"});
  dateEl.textContent = now.toLocaleDateString(undefined, {
    weekday:"long", month:"long", day:"numeric"
  });
}
setInterval(updateClock, 1000);
updateClock();

/* ========= GOOGLE CALENDAR ========= */
const CLIENT_ID = "703875968822-6ma5u7st5qm3eqgb1ktt9p52vs8knrb3.apps.googleusercontent.com";
const API_KEY = "AIzaSyCcx8q0nHP9DkA-M_KFyjFo-uLV-7TOrSE";
const SCOPES = "https://www.googleapis.com/auth/calendar.readonly";
const DISCOVERY_DOC = "https://www.googleapis.com/discovery/v1/apis/calendar/v3/rest";

let tokenClient;
let gapiReady = false;
let gisReady = false;
let calendarEvents = [];

function gapiLoaded() {
  console.log("gapi loaded");
  gapi.load("client", async () => {
    await gapi.client.init({ apiKey: API_KEY, discoveryDocs:[DISCOVERY_DOC] });
    gapiReady = true;
    maybeAuth();
  });
}

function gisLoaded() {
  console.log("gis loaded");
  tokenClient = google.accounts.oauth2.initTokenClient({
    client_id: CLIENT_ID,
    scope: SCOPES,
    callback: ""
  });
  gisReady = true;
  maybeAuth();
}

function
